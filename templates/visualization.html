{% extends 'admin_index.html' %}

{% block content %}
<div class="container">
    <h2>Welcome, {{ user.username }}</h2>
    
   

    <!-- Most Popular Posts Chart -->
    <div class="card mb-3">
        <div class="card-header">Top 5 Most Liked Posts</div>
        <div class="card-body">
            <canvas id="popularPostsChart"></canvas>
        </div>
    </div>
</div>

 <!-- Posts by Category Chart -->
 <div class="card mb-3">
    <div class="card-header">Posts by Category</div>
    <div class="card-body">
        <canvas id="postsByCategoryChart"></canvas>
    </div>
</div>



<!-- Trending Posts Chart -->
<div class="card mb-3">
    <div class="card-header">Trending Posts</div>
    <div class="card-body">
        <canvas id="trendingPostsChart"></canvas>
    </div>
</div>



</div>

<!-- Chart.js Script -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script type="text/javascript">
    var ctx = document.getElementById('popularPostsChart').getContext('2d');
    var chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [{% for post in most_popular_posts %}"{{ post.title }}",{% endfor %}],
            datasets: [{
                label: 'Likes',
                data: [{% for post in most_popular_posts %}{{ post.likes_count }},{% endfor %}],
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        stepSize: 1, // Set step size to 1 to avoid decimal points
                    }
                }
            }
        }
    });



     // Posts by Category Chart
     var ctx2 = document.getElementById('postsByCategoryChart').getContext('2d');
     var postsByCategoryChart = new Chart(ctx2, {
         type: 'bar',
         data: {
             labels: [{% for category in posts_by_category %}"{{ category.category_id__name }}",{% endfor %}],
             datasets: [{
                 label: 'Post Count',
                 data: [{% for category in posts_by_category %}{{ category.count }},{% endfor %}],
                 backgroundColor: 'rgba(153, 102, 255, 0.2)',
                 borderColor: 'rgba(153, 102, 255, 1)',
                 borderWidth: 1
             }]
         },
         options: {
             scales: {
                 y: {
                     beginAtZero: true,
                     ticks: {
                        stepSize: 1, // Set step size to 1 to avoid decimal points
                    }
                 }
             }
         }
     });

//trending post
     var ctx = document.getElementById('trendingPostsChart').getContext('2d');
var trendingPostsChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: [{% for post in trending_posts %}"{{ post.title }}",{% endfor %}],
        datasets: [{
            label: 'Trending Score',
            data: [{% for post in trending_posts %}{{ post.trending_score }},{% endfor %}],
            backgroundColor: 'rgba(255, 206, 86, 0.2)',
            borderColor: 'rgba(255, 206, 86, 1)',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true,
                ticks: {
                    stepSize: 1,
                }
            }
        }
    }
});

</script>

{% endblock %}
